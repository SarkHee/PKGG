// Prisma schema for clans and clan members
// Save as prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Clan {
  id           Int           @id @default(autoincrement())
  name         String        @unique
  leader       String
  description  String?
  announcement String?
  memberCount  Int
  avgScore     Int?
  mainStyle    String?
  members      ClanMember[]
}

model ClanMember {
  id             Int     @id @default(autoincrement())
  nickname       String
  score          Int
  style          String
  avgDamage      Float
  avgKills       Float   @default(0)
  avgAssists     Float   @default(0)
  avgSurviveTime Float   @default(0)
  winRate        Float   @default(0)
  top10Rate      Float   @default(0)
  clanId         Int
  clan           Clan    @relation(fields: [clanId], references: [id])
  matches        PlayerMatch[]
  modeStats      PlayerModeStats[]
}

model PlayerMatch {
  id           Int      @id @default(autoincrement())
  clanMember   ClanMember @relation(fields: [clanMemberId], references: [id])
  clanMemberId Int
  matchId      String   // PUBG match id
  mode         String   // solo/duo/squad 등
  mapName      String?
  placement    Int
  kills        Int
  assists      Int
  // UBD 클랜 멤버에 'soo5woo', 'a-ing-a-ing' 추가
  // ...existing code...
  damage       Float
  surviveTime  Float
  createdAt    DateTime @default(now())
}

model PlayerModeStats {
  id           Int      @id @default(autoincrement())
  clanMember   ClanMember @relation(fields: [clanMemberId], references: [id])
  clanMemberId Int
  mode         String   // solo/duo/squad/fpp/tpp 등
  matches      Int
  wins         Int
  top10s       Int
  avgDamage    Float
  avgKills     Float
  avgAssists   Float
  winRate      Float
  top10Rate    Float
}
